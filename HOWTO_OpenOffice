///////////////////////////////////////////////////////////////////////////////
//              Using Unoconv with OpenOffice af Fedora 12                   //
///////////////////////////////////////////////////////////////////////////////

//first check whether unoconv is installed at all =)
[root@localhost ~]# yum info unoconv
//Must have INSTALLED note at Repository field

//Give it a try
[root@localhost ~]# unoconv -f html sample.doc 
Error: Unable to connect or start own listener. Aborting.
//Ooops, something is wrong

//Check whether OpenOffice is installed
[root@localhost ~]# yum info openoffice.org-writer
//Install if it is not
[root@localhost ~]# yum install openoffice.org-writer

//Try again
[root@localhost ~]# unoconv -f html sample.doc 
/usr/lib/openoffice.org3/program/soffice.bin X11 error: Can't open display: 
   Set DISPLAY environment variable, use -display option
   or check permissions of your X-Server
   (See "man X" resp. "man xhost" for details)
Error: Unable to connect or start own listener. Aborting.
//Okay, bad thing. We will need X virtual buffer

//Check whether Xvbf is installed
[root@localhost ~]# yum info xorg-x11-server-Xvfb
//Install it if it is not
[root@localhost ~]# yum install xorg-x11-server-Xvfb

//Try it
[root@localhost ~]# xvfb-run -f /tmp/anyXauthority soffice
^C[root@localhost ~]# 
//Seems like working. [^C - means CTRL + C was pressed to terminate ongoing job]

//Run it in the background
[root@localhost /]# Xvfb :2
(EE) config/hal: NewInputDeviceRequest failed (2)
(EE) config/hal: NewInputDeviceRequest failed (2)
(EE) config/hal: NewInputDeviceRequest failed (2)
^C
//Wooo, bad thing. But don't scare. This error does not prevent it from working.
//Just suppress error messages and run it in the background 
[root@localhost /]# Xvfb :2 2>/dev/null &
[2] 22360
//Seems OK

//Get it from background and terminate the job.
[root@localhost /]# fg
Xvfb :2 2> /dev/null
^C[root@localhost /]#

//Now we need to set up DISPLAY environmental variable for OO to work with XVFB
[root@localhost /]# export DISPLAY=localhost:2.0 

//Here we go!
[root@localhost /]# Xvfb :2 2>/dev/null &
[2] 22370

//TRY AGAIN!
[root@localhost /]# unoconv -f html sample.doc 
Xlib:  extension "RANDR" missing on display "localhost:2.0".
//Success!! Yep, this error also can be ignored. 

//Suppress the error when using unoconv
[root@localhost ~]# unoconv -f html sample.doc 2>/dev/null
//YES!!! WE DID IT!

//Once finished, shutdown the virtual frame buffer 
[root@localhost ~]# fg
Xvfb :2 2> /dev/null	(wd: /)
^C

///////////////////////////////////////////////////////////////////////////////
